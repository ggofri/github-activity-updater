#!/bin/bash

set -euo pipefail

echo "🧪 Running pre-commit tests..."

if ! make test-all; then
    echo "❌ Tests failed! Commit blocked."
    echo "Fix the failing tests before committing."
    exit 1
fi

if command -v shellcheck >/dev/null 2>&1; then
    echo "🔍 Running shellcheck..."
    if ! make lint; then
        echo "⚠️  Shellcheck found issues! Please fix them before committing."
        exit 1
    fi
else
    echo "⚠️  Shellcheck not found, skipping lint check"
fi

echo "✅ All pre-commit checks passed!"
